{% load staticfiles %}
{% url 'general:home' as about_url %}
{% url 'general:immersion' as immersion_url %}
{% url 'general:events' as events_url %}
{% url 'general:school_year' as school_year_url %}
{% url 'general:programs' as programs_url %}
<nav class="navbar navbar-fixed-top navbar-dark navbar-expand-lg container-fluid">
    <a class="navbar-brand navbar-link" href="{% url 'general:home' %}">
    <header class="header-top">
        <div class="row no-gutters text-center">
            <section class="col-12 col-md-7 col-lg-6 col-xl-5 order-2 order-md-1 align-self-center">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tangerine">
                {% if request.path == about_url %}
                <h1 class="d-none d-lg-block">Kate Alm Suzuki Piano Studio</h1>
                <h1 class="d-lg-none">Kate Alm</h1>
                {% endif %}
                {% if request.path == events_url %}
                <h1 class="d-none d-lg-block">Events and Contact Information</h1>
                <h1 class="d-lg-none">Events &amp Contact</h1>
                <h3 class="d-none d-lg-block">Kate Alm Suzuki Piano Studio</h3>
                {% endif %}
                {% if request.path == immersion_url %}
                <h1 class="d-none d-lg-block">Immersion Program - New Students</h1>
                <h1 class="d-lg-none">Immersion</h1>
                <h3 class="d-none d-lg-block">Kate Alm Suzuki Piano Studio</h3>
                {% endif %}
                {% if request.path == school_year_url %}
                <h1 class="d-none d-lg-block">School Year and Summer Policies</h1>
                <h1 class="d-lg-none">Current Students</h1>
                <h3 class="d-none d-lg-block">Kate Alm Suzuki Piano Studio</h3>
                {% endif %}
                {% if request.path == programs_url %}
                <h1 class="d-none d-lg-block">Studio Culture</h1>
                <h1 class="d-lg-none">Studio Culture</h1>
                <h3 class="d-none d-lg-block">Kate Alm Suzuki Piano Studio</h3>
                {% endif %}
            </section>
        </div>
        <!-- this is the pay pal button and link -->
        <div id="smart-button-container">
    <div style="text-align: center"><label for="description">Livestream, November 7th </label><input type="text" name="descriptionInput" id="description" maxlength="127" value=""></div>
      <p id="descriptionError" style="visibility: hidden; color:red; text-align: center;">Please enter a description</p>
    <div style="text-align: center"><label for="amount">$30.00-$100.00 </label><input name="amountInput" type="number" id="amount" value="" ><span> USD</span></div>
      <p id="priceLabelError" style="visibility: hidden; color:red; text-align: center;">Please enter a price</p>
    <div id="invoiceidDiv" style="text-align: center; display: none;"><label for="invoiceid"> </label><input name="invoiceid" maxlength="127" type="text" id="invoiceid" value="" ></div>
      <p id="invoiceidError" style="visibility: hidden; color:red; text-align: center;">Please enter an Invoice ID</p>
    <div style="text-align: center; margin-top: 0.625rem;" id="paypal-button-container"></div>
  </div>
  <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD" data-sdk-integration-source="button-factory"></script>
  <script>
  function initPayPalButton() {
    var description = document.querySelector('#smart-button-container #description');
    var amount = document.querySelector('#smart-button-container #amount');
    var descriptionError = document.querySelector('#smart-button-container #descriptionError');
    var priceError = document.querySelector('#smart-button-container #priceLabelError');
    var invoiceid = document.querySelector('#smart-button-container #invoiceid');
    var invoiceidError = document.querySelector('#smart-button-container #invoiceidError');
    var invoiceidDiv = document.querySelector('#smart-button-container #invoiceidDiv');

    var elArr = [description, amount];

    if (invoiceidDiv.firstChild.innerHTML.length > 1) {
      invoiceidDiv.style.display = "block";
    }

    var purchase_units = [];
    purchase_units[0] = {};
    purchase_units[0].amount = {};

    function validate(event) {
      return event.value.length > 0;
    }

    paypal.Buttons({
      style: {
        color: 'gold',
        shape: 'pill',
        label: 'pay',
        layout: 'vertical',
        
      },

      onInit: function (data, actions) {
        actions.disable();

        if(invoiceidDiv.style.display === "block") {
          elArr.push(invoiceid);
        }

        elArr.forEach(function (item) {
          item.addEventListener('keyup', function (event) {
            var result = elArr.every(validate);
            if (result) {
              actions.enable();
            } else {
              actions.disable();
            }
          });
        });
      },

      onClick: function () {
        if (description.value.length < 1) {
          descriptionError.style.visibility = "visible";
        } else {
          descriptionError.style.visibility = "hidden";
        }

        if (amount.value.length < 1) {
          priceError.style.visibility = "visible";
        } else {
          priceError.style.visibility = "hidden";
        }

        if (invoiceid.value.length < 1 && invoiceidDiv.style.display === "block") {
          invoiceidError.style.visibility = "visible";
        } else {
          invoiceidError.style.visibility = "hidden";
        }

        purchase_units[0].description = description.value;
        purchase_units[0].amount.value = amount.value;

        if(invoiceid.value !== '') {
          purchase_units[0].invoice_id = invoiceid.value;
        }
      },

      createOrder: function (data, actions) {
        return actions.order.create({
          purchase_units: purchase_units,
        });
      },

      onApprove: function (data, actions) {
        return actions.order.capture().then(function (details) {
          alert('Transaction completed by ' + details.payer.name.given_name + '!');
        });
      },

      onError: function (err) {
        console.log(err);
      }
    }).render('#paypal-button-container');
  }
  initPayPalButton();
  </script>
        <div>
            {% if request.path == about_url %}
        	<section>
        	<p style="color:#9166b8">
                <h3><p><strong>Studio is open for prospective students<a class="nav-link" href="{% url 'general:immersion' %}">September 15-30</a></strong></p></h3>
                <p><a href="https://katealmsuzukipianostudio.com/programs#blm">Read Kate's statement in support of Black Lives Matter</a></p>
                <p><a href="https://suzukiassociation.org/news/cultivating-oestrong-arms-treea-keeping-teens/">Kateâ€™s Article about her Suzuki Student-to-Student Mentoring program has been published!</a></p>
                <p>Musical Soulmates Series: Raising funds and awareness for Music in May and NAACP Santa Cruz. <a href="https://www.eventbrite.com/e/musical-soulmates-music-of-the-americas-and-their-influence-tickets-116926168317?aff=ebdssbonlinesearch" target="_blank">  First Concert is November 7th</a></p>
        	</p>
        	</section>
            {% endif %}
        </div>
    </header>
    </a>
    <button class="navbar-toggler navbar-toggler-right navbar-toggler-icon" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fa home" aria-hidden="true" id="bars"></i></span>
    </button>

    <div class="collapse navbar-collapse float-right" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto text-center text-md-left">
            <li id="nav-about" class="nav-item {% if request.path == about_url %}active{% endif %}"><a class="nav-link" href="{% url 'general:home' %}">Home Page</a></li>
            <li id="nav-events" class="nav-item {% if request.path == events_url %}active{% endif %}"><a class="nav-link" href="{% url 'general:events' %}">Events & Contact</a></li>
            <li id="nav-immersion" class="nav-item {% if request.path == immersion_url %}active{% endif %}"><a class="nav-link" href="{% url 'general:immersion' %}">Prospective Students</a></li>
            <li id="nav-school" class="nav-item {% if request.path == school_year_url %}active{% endif %}"><a class="nav-link" href="{% url 'general:school_year' %}">Current Students</a></li>
            <li id="nav-programs" class="nav-item {% if request.path == programs_url %}active{% endif %}"><a class="nav-link" href="{% url 'general:programs' %}">Studio Culture</a></li>
        </ul>
    </div>
</nav>
